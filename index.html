<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>StarWatch</title>
    <script
            src="https://code.jquery.com/jquery-3.3.1.js"
            integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
            crossorigin="anonymous">
    </script>

    <link rel="stylesheet" href="style/main.css" type="text/css">
    <link rel="stylesheet" href="style/videos.css" type="text/css">
    <link rel="stylesheet" href="style/login.css" type="text/css">
    <link rel="stylesheet" href="style/register.css" type="text/css">
</head>
<body>
    <header></header>
    <main id="mainMain" class=""></main>
    <footer></footer>
</body>
<script>
    $(function(){
        $("header").load("view/header.html");
        $("main").load("main.html");
        $("footer").load("view/footer.html");
    });

    function openChat(isOpen) {
        //alert(isOpen);
        let chat = document.getElementById("chat");
        let aside = document.getElementsByTagName("aside")[0];
        alert(chat);
        if (isOpen == 0) {
            chat.style.display = "";
            aside.onclick = function () {openChat(1)};
        } else if ( isOpen == 1 ) {
            chat.style.display = "none";
            aside.onclick = function () {openChat(0)};
        }
    }
    //TODO: allgemeine Funktionen hier einbetten

    function navigation(nav, logged) {
        let navItem;
        let navItems;
        switch (nav) {
            case "filme":
                navItem = document.getElementById("navFilme");
                $("main").load("video.html");
                break;
            case "serien":
                navItem = document.getElementById("navSerien");
                $("main").load("video.html");
                break;
            case "login":
                //open a popup window

                //get window center
                let height = ($(window).height() - 185) / 2;
                let width = ($(window).width() - 280) / 2;

                window.open('login.html','_blank', "top=" + height + ",left=" + width + ",height=185,width=280");
                break;
            case "register":
                $("main").load("register.html");
                break;
            case "profile":
                navItem = document.getElementById("navLogin");
                $("main").load("profile.html");
                break;
            case "group":
                $("main").load("group.html");
                break;
            case "videos":
                $("main").load("videolist.html");
                break;
            case "main":
                $("main").load("main.html");
                break;
            case "events":
                //TODO
                break;
            default :
                alert("Unknown handler: " + nav)
        }

        if (logged === true) {
            setProfile();
        } else if (logged === false) {
            setLogin();
        }

        if (navItem) {
            navItems = document.getElementsByClassName("pseudolink");
            Array.prototype.forEach.call(navItems, item => {item.style.backgroundColor="#555"})
            navItem.style.backgroundColor = "#444";
        }
    }

    function setProfile () {
        let damn = document.getElementById("navLogin");
        damn.onclick = function () {
            navigation('profile');
        }
        damn.innerText = "Profil";
    }

    function setLogin () {
        let damn = document.getElementById("navLogin");
        damn.onclick = function () {
            navigation('login');
        }
        damn.innerText = "Login";
    }
</script>
</html>